{% extends "layout.html" %}
{% block content %}

<h1 class="title">Watchlist Heatmap</h1>
<p class="subtitle">Red = Nuclear • Green = Dead</p>
<p class="time">Last update: {{ time }}</p>

<div class="heatmap-grid">
    {% for s in stocks %}
    <div class="heat-cell" 
         style="--score: {{ s.god_score_100|default(800) }};"
         title="{{ s.ticker }} • {{ s.name }} • Score: {{ s.god_score_100 }} • {{ s.sector }}">
        <div class="ticker">{{ s.ticker }}</div>
        <div class="score">{{ s.god_score_100 }}</div>
        <div class="sector">{{ s.sector }}</div>
    </div>
    {% endfor %}
</div>

<style>
.heatmap-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
    gap: 16px;
    padding: 2rem;
    max-width: 1800px;
    margin: 0 auto;
}
.heat-cell {
    --intensity: calc((var(--score) - 600) / 1400);
    background: linear-gradient(to bottom,
        #00ff00 0%,
        #88ff00 20%,
        #ffff00 40%,
        #ff8800 60%,
        #ff3300 80%,
        #ff0040 100%
    );
    background-size: 100% 300%;
    background-position: 0% calc(100% - (var(--intensity) * 100%));
    color: white;
    padding: 1.3rem 0.8rem;
    border-radius: 20px;
    text-align: center;
    font-weight: bold;
    box-shadow: 0 8px 30px rgba(0,0,0,0.5);
    transition: all 0.4s ease;
    cursor: pointer;
}
.heat-cell:hover {
    transform: scale(1.2) translateY(-10px);
    z-index: 100;
    box-shadow: 0 30px 60px rgba(255,0,0,0.8);
}
.ticker { font-size: 1.6rem; font-weight: 900; text-shadow: 0 2px 6px rgba(0,0,0,0.8); }
.score { font-size: 1.4rem; margin: 8px 0; }
.sector { font-size: 0.9rem; opacity: 0.9; }
</style>

{% endblock %}